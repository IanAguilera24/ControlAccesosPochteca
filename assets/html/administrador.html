<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Accesos</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="icon" href="../resources/images/grupo_pochteca_logo.jfif" type="image/svg+xml">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <img src="../resources/images/grupo_pochteca_logo.jfif" alt="Logo Empresa" id="companyLogo">
            </div>
            <div class="header-text">
                <h1>Control de Accesos</h1>
                <h2>Sistema de Registro de Visitantes y Clientes</h2>
            </div>
        </header>
        
        <!-- Botón para abrir el menú lateral -->
        <button id="sideMenuToggle" class="side-menu-toggle">☰</button>

        <!-- Menú lateral -->
        <div id="sideMenu" class="side-menu">
            <div class="side-menu-header">
                <h3>Configuración</h3>
                <button id="closeSideMenu" class="close-side-menu">&times;</button>
            </div>
            
            <div class="side-menu-content">
                <!-- Tabs del menú -->
                <div class="side-menu-tabs">
                    <button class="side-tab-button active" onclick="openSideTab('changePassword')">Cambiar Contraseña</button>
                    <button class="side-tab-button" id="createUserTab" onclick="openSideTab('createUser')">Crear Usuario</button>
                </div>
                
                <!-- Contenido de cambiar contraseña -->
                <div id="changePassword" class="side-tab-content active">
                    <form id="changePasswordForm">
                        <div class="form-group">
                            <label for="currentPassword">Contraseña Actual:</label>
                            <input type="password" id="currentPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="newPassword">Nueva Contraseña:</label>
                            <input type="password" id="newPassword" required minlength="8">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirmar Nueva Contraseña:</label>
                            <input type="password" id="confirmPassword" required minlength="8">
                        </div>
                        <button type="submit" class="btn menu-btn">Cambiar Contraseña</button>
                    </form>
                </div>
                
                <!-- Contenido de crear usuario -->
                <div id="createUser" class="side-tab-content">
                    <form id="createUserForm">
                        <div class="form-group">
                            <label for="newUserEmail">Email:</label>
                            <input type="email" id="newUserEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="newUserPassword">Contraseña:</label>
                            <input type="password" id="newUserPassword" required minlength="8">
                        </div>
                        <div class="form-group">
                            <label for="newUserRole">Rol:</label>
                            <select id="newUserRole" required>
                                <option value="">Seleccione un rol</option>
                                <option value="admin">Administrador</option>
                                <option value="guardia">Guardia</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="newUserBranch">Sucursal:</label>
                            <select id="newUserBranch" required>
                                <option value="">Seleccione la sucursal</option>
                                <option value="Aguascalientes">Aguascalientes</option>
                                <option value="Cancun">Cancún</option>
                                <option value="Cd. Juarez">Cd. Juárez</option>
                                <option value="Cd. Obregon">Cd. Obregón</option>
                                <option value="Chihuahua">Chihuahua</option>
                                <option value="Cuernavaca">Cuernavaca</option>
                                <option value="Culiacan">Culiacán</option>
                                <option value="Guadalajara">Guadalajara</option>
                                <option value="Hermosillo">Hermosillo</option>
                                <option value="Leon">León</option>
                                <option value="Merida">Mérida</option>
                                <option value="Minatitlan">Minatitlán</option>
                                <option value="Monterrey">Monterrey</option>
                                <option value="Morelia">Morelia</option>
                                <option value="Pachuca">Pachuca</option>
                                <option value="Puebla">Puebla</option>
                                <option value="Queretaro">Querétaro</option>
                                <option value="Reynosa">Reynosa</option>
                                <option value="San Jose">San José</option>
                                <option value="San Juan">San Juan</option>
                                <option value="San Luis Potosi">San Luis Potosí</option>
                                <option value="Tampico">Tampico</option>
                                <option value="Tijuana">Tijuana</option>
                                <option value="Toluca">Toluca</option>
                                <option value="Torreon">Torreón</option>
                                <option value="Tuxtla">Tuxtla</option>
                                <option value="Vallejo">Vallejo</option>
                                <option value="Veracruz">Veracruz</option>
                                <option value="Villahermosa">Villahermosa</option>
                            </select>
                        </div>
                        <button type="submit" class="btn menu-btn">Crear Usuario</button>
                    </form>
                </div>
                
                <!-- Botón de cerrar sesión -->
                <div class="logout-section">
                    <button id="logoutBtn" class="btn logout-btn">Cerrar Sesión</button>
                </div>
            </div>
        </div>

        <!-- Overlay para el menú -->
        <div id="sideMenuOverlay" class="side-menu-overlay"></div>

        <div class="content-wrapper">
            <section class="registration-section">
                <h2>Registro de Entrada</h2>
                
                <div class="visitor-type">
                    <label>
                        <input type="radio" name="visitorType" value="Cliente" checked> Cliente
                    </label>
                    <label>
                        <input type="radio" name="visitorType" value="Visitante"> Visitante
                    </label>
                </div>
                
                <form id="registrationForm">
                    <div class="form-group">
                        <label for="sucursal">Sucursal que visita:</label>
                        <select id="sucursal" required>
                            <option value="">Seleccione la sucursal</option>
                            <option value="Aguascalientes">Aguascalientes</option>
                            <option value="Cancun">Cancún</option>
                            <option value="Cd. Juarez">Cd. Juárez</option>
                            <option value="Cd. Obregon">Cd. Obregón</option>
                            <option value="Chihuahua">Chihuahua</option>
                            <option value="Cuernavaca">Cuernavaca</option>
                            <option value="Culiacan">Culiacán</option>
                            <option value="Guadalajara">Guadalajara</option>
                            <option value="Hermosillo">Hermosillo</option>
                            <option value="Leon">León</option>
                            <option value="Merida">Mérida</option>
                            <option value="Minatitlan">Minatitlán</option>
                            <option value="Monterrey">Monterrey</option>
                            <option value="Morelia">Morelia</option>
                            <option value="Pachuca">Pachuca</option>
                            <option value="Puebla">Puebla</option>
                            <option value="Queretaro">Querétaro</option>
                            <option value="Reynosa">Reynosa</option>
                            <option value="San Jose">San José</option>
                            <option value="San Juan">San Juan</option>
                            <option value="San Luis Potosi">San Luis Potosí</option>
                            <option value="Tampico">Tampico</option>
                            <option value="Tijuana">Tijuana</option>
                            <option value="Toluca">Toluca</option>
                            <option value="Torreon">Torreón</option>
                            <option value="Tuxtla">Tuxtla</option>
                            <option value="Vallejo">Vallejo</option>
                            <option value="Veracruz">Veracruz</option>
                            <option value="Villahermosa">Villahermosa</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="entryTime">Hora de Entrada:</label>
                        <input type="text" id="entryTime" readonly>
                    </div>
                    
                    <!-- Campos específicos para Cliente -->
                    <div id="clientFields">
                        <div class="form-group">
                            <label for="companyName">Razón Social (opcional):</label>
                            <input type="text" id="companyName" placeholder="Nombre de la empresa">
                        </div>
                        
                        <div class="form-group">
                            <label for="clientPersonName">Nombre de la persona:</label>
                            <input type="text" id="clientPersonName" placeholder="Nombre completo" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="product">Producto que viene a recoger (opcional):</label>
                            <input type="text" id="product" placeholder="Nombre del producto">
                        </div>
                    </div>
                    
                    <!-- Campos específicos para Visitante -->
                    <div id="visitorFields" style="display: none;">
                        <div class="form-group">
                            <label for="visitorName">Nombre completo:</label>
                            <input type="text" id="visitorName" placeholder="Nombre y apellidos" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="visitPurpose">Motivo de la visita:</label>
                            <select id="visitPurpose" required>
                                <option value="">Seleccione un motivo</option>
                                <option value="Entrevista">Entrevista</option>
                                <option value="Soy proveedor">Soy proveedor</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="personToVisit">Persona a la que viene a ver:</label>
                            <input type="text" id="personToVisit" placeholder="Nombre del colaborador" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="area">Área (opcional):</label>
                            <input type="text" id="area" placeholder="Departamento/Área">
                        </div>
                    </div>
                    
                    <!-- Campo de observaciones común -->
                    <div class="form-group">
                        <label for="observations">Observaciones:</label>
                        <textarea id="observations" rows="2" placeholder="Notas adicionales"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="vehicleType">Tipo de vehículo:</label>
                        <select id="vehicleType" required>
                            <option value="">Seleccione tipo</option>
                            <option value="Automóvil">Automóvil</option>
                            <option value="Camioneta">Camioneta</option>
                            <option value="Motocicleta">Motocicleta</option>
                            <option value="Camión">Camión</option>
                            <option value="Otro">Otro</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="licensePlate">Marca y Placa del vehículo:</label>
                        <input type="text" id="licensePlate" placeholder="Marca y Placa del vehículo" maxlength="30" required>
                    </div>
                    
                    <button type="button" id="registerEntryBtn" class="btn register-btn">Registrar Entrada</button>
                </form>
            </section>
            
            <section class="active-records">
                <h2>Registros</h2>
                <div class="controls-container">
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Buscar por Nombre/Razón Social...">
                    </div>
                    
                    <div class="date-filter-container">
                        <label for="dateFilter">Filtrar por fecha:</label>
                        <input type="date" id="dateFilter">
                    </div>
                </div>
                
                <div class="tab-container">
                    <button class="tab-button active" onclick="openTab('pending')">Entradas sin salida</button>
                    <button class="tab-button" onclick="openTab('completed')">Entradas con salida</button>
                </div>
                
                <div class="table-container">
                    <div id="pending" class="tab-content" style="display:block">
                        <table id="pendingTable">
                            <thead>
                                <tr>
                                    <th>Tipo</th>
                                    <th>Nombre/Razón Social</th>
                                    <th>Sucursal</th>
                                    <th>Fecha/Hora Entrada</th>
                                    <th>Detalles</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="pendingBody">
                                <!-- Registros pendientes se agregarán aquí -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="completed" class="tab-content">
                        <table id="completedTable">
                            <thead>
                                <tr>
                                    <th>Tipo</th>
                                    <th>Nombre/Razón Social</th>
                                    <th>Sucursal</th>
                                    <th>Fecha/Hora Entrada</th>
                                    <th>Fecha/Hora Salida</th>
                                    <th>Detalles</th>
                                </tr>
                            </thead>
                            <tbody id="completedBody">
                                <!-- Registros completados se agregarán aquí -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="pagination-container">
                    <div class="pagination-info" id="pendingPaginationInfo"></div>
                    <div class="pagination-controls" id="pendingPaginationControls"></div>
                    
                    <div class="pagination-info" id="completedPaginationInfo" style="display:none"></div>
                    <div class="pagination-controls" id="completedPaginationControls" style="display:none"></div>
                </div>
                <button id="exportBtn" class="btn export-btn">Exportar Registros</button>
            </section>
        </div>
    </div>
    <!-- Modal para detalles -->
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3>Detalles del Registro</h3>
            <div id="modalDetailsContent" class="modal-body"></div>
        </div>
    </div>

    <!-- Notificaciones Toast -->
    <div id="toastContainer" class="toast-container"></div>
    <!-- Scripts locales -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="../js/firebase-config.js"></script>
    <script src="../js/script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>